import{i as W,O as x,at as X,m as V,h as S,l as p,D as Y,H as ee,o as m,e as h,w,q as se,a as L,n as g,s as a,C as oe,f as T,V as ne,y as te,c as O,t as ae,S as re,z as le,b as $,R as ie,a9 as ce,A as ue,j as D,N as q,aq as M,aa as H,ab as de}from"./index-c36c71de.js";import{c as pe,u as me,E as fe}from"./index-9f2e366b.js";import{E as ge}from"./el-badge-e232ad28.js";import{e as A,E as _,u as ye,i as ve,f as Ce}from"./index-7bbb7502.js";import{m as he}from"./typescript-defaf979.js";import{i as be,T as F,a as Te}from"./icon-ec529186.js";import{u as Ee}from"./use-global-config-9c175522.js";const R={},P=["success","info","warning","error"],l=he({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:A?document.body:void 0}),Ne=W({customClass:{type:String,default:l.customClass},center:{type:Boolean,default:l.center},dangerouslyUseHTMLString:{type:Boolean,default:l.dangerouslyUseHTMLString},duration:{type:Number,default:l.duration},icon:{type:be,default:l.icon},id:{type:String,default:l.id},message:{type:x([String,Object,Function]),default:l.message},onClose:{type:x(Function),required:!1},showClose:{type:Boolean,default:l.showClose},type:{type:String,values:P,default:l.type},offset:{type:Number,default:l.offset},zIndex:{type:Number,default:l.zIndex},grouping:{type:Boolean,default:l.grouping},repeatNum:{type:Number,default:l.repeatNum}}),Se={destroy:()=>!0},c=X([]),we=s=>{const o=c.findIndex(t=>t.id===s),e=c[o];let r;return o>0&&(r=c[o-1]),{current:e,prev:r}},Me=s=>{const{prev:o}=we(s);return o?o.vm.exposed.bottom.value:0},ke=(s,o)=>c.findIndex(r=>r.id===s)>0?20:o,ze=["id"],Be=["innerHTML"],Ie=V({name:"ElMessage"}),xe=V({...Ie,props:Ne,emits:Se,setup(s,{expose:o}){const e=s,{Close:r}=Te,{ns:t,zIndex:u}=Ee("message"),{currentZIndex:i,nextZIndex:d}=u,f=S(),v=S(!1),C=S(0);let E;const j=p(()=>e.type?e.type==="error"?"danger":e.type:"info"),Z=p(()=>{const n=e.type;return{[t.bm("icon",n)]:n&&F[n]}}),k=p(()=>e.icon||F[e.type]||""),G=p(()=>Me(e.id)),z=p(()=>ke(e.id,e.offset)+G.value),J=p(()=>C.value+z.value),K=p(()=>({top:`${z.value}px`,zIndex:i.value}));function N(){e.duration!==0&&({stop:E}=ye(()=>{b()},e.duration))}function B(){E==null||E()}function b(){v.value=!1}function Q({code:n}){n===fe.esc&&b()}return Y(()=>{N(),d(),v.value=!0}),ee(()=>e.repeatNum,()=>{B(),N()}),pe(document,"keydown",Q),me(f,()=>{C.value=f.value.getBoundingClientRect().height}),o({visible:v,bottom:J,close:b}),(n,I)=>(m(),h(ce,{name:a(t).b("fade"),onBeforeLeave:n.onClose,onAfterLeave:I[0]||(I[0]=Fe=>n.$emit("destroy")),persisted:""},{default:w(()=>[se(L("div",{id:n.id,ref_key:"messageRef",ref:f,class:g([a(t).b(),{[a(t).m(n.type)]:n.type&&!n.icon},a(t).is("center",n.center),a(t).is("closable",n.showClose),n.customClass]),style:oe(a(K)),role:"alert",onMouseenter:B,onMouseleave:N},[n.repeatNum>1?(m(),h(a(ge),{key:0,value:n.repeatNum,type:a(j),class:g(a(t).e("badge"))},null,8,["value","type","class"])):T("v-if",!0),a(k)?(m(),h(a(_),{key:1,class:g([a(t).e("icon"),a(Z)])},{default:w(()=>[(m(),h(ne(a(k))))]),_:1},8,["class"])):T("v-if",!0),te(n.$slots,"default",{},()=>[n.dangerouslyUseHTMLString?(m(),O(re,{key:1},[T(" Caution here, message could've been compromised, never use user's input as message "),L("p",{class:g(a(t).e("content")),innerHTML:n.message},null,10,Be)],2112)):(m(),O("p",{key:0,class:g(a(t).e("content"))},ae(n.message),3))]),n.showClose?(m(),h(a(_),{key:2,class:g(a(t).e("closeBtn")),onClick:le(b,["stop"])},{default:w(()=>[$(a(r))]),_:1},8,["class","onClick"])):T("v-if",!0)],46,ze),[[ie,v.value]])]),_:3},8,["name","onBeforeLeave"]))}});var Le=ue(xe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let Oe=1;const U=s=>{const o=!s||D(s)||q(s)||M(s)?{message:s}:s,e={...l,...o};if(!e.appendTo)e.appendTo=document.body;else if(D(e.appendTo)){let r=document.querySelector(e.appendTo);Ce(r)||(r=document.body),e.appendTo=r}return e},De=s=>{const o=c.indexOf(s);if(o===-1)return;c.splice(o,1);const{handler:e}=s;e.close()},He=({appendTo:s,...o},e)=>{const r=`message_${Oe++}`,t=o.onClose,u=document.createElement("div"),i={...o,id:r,onClose:()=>{t==null||t(),De(C)},onDestroy:()=>{H(null,u)}},d=$(Le,i,M(i.message)||q(i.message)?{default:M(i.message)?i.message:()=>i.message}:null);d.appContext=e||y._context,H(d,u),s.appendChild(u.firstElementChild);const f=d.component,C={id:r,vnode:d,vm:f,handler:{close:()=>{f.exposed.visible.value=!1}},props:d.component.props};return C},y=(s={},o)=>{if(!A)return{close:()=>{}};if(ve(R.max)&&c.length>=R.max)return{close:()=>{}};const e=U(s);if(e.grouping&&c.length){const t=c.find(({vnode:u})=>{var i;return((i=u.props)==null?void 0:i.message)===e.message});if(t)return t.props.repeatNum+=1,t.props.type=e.type,t.handler}const r=He(e,o);return c.push(r),r.handler};P.forEach(s=>{y[s]=(o={},e)=>{const r=U(o);return y({...r,type:s},e)}});function _e(s){for(const o of c)(!s||s===o.props.type)&&o.handler.close()}y.closeAll=_e;y._context=null;const je=de(y,"$message");export{je as E};
